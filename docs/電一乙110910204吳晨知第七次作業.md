# ç¨‹å¼è¨­è¨ˆ
<h2>ç¬¬åç« </h2>  
<h3>é›»å­å·¥ç¨‹ç³»ä¸€å¹´ä¹™ç­</h3>  
<h5>110910204</h5>  
<h5>å³æ™¨çŸ¥</h5>  
<h5>æ•™æˆï¼šæé‡‘è­š</h5>  

# ç›®éŒ„

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->
<!-- code_chunk_output -->

- [ç¨‹å¼è¨­è¨ˆ](#ç¨‹å¼è¨­è¨ˆ)
- [ç›®éŒ„](#ç›®éŒ„)
- [ç­†è¨˜](#ç­†è¨˜)
  - [ISO C++ forbids converting a string constant to â€˜char*â€™](#iso-c-forbids-converting-a-string-constant-to-char)
- [ä½œæ¥­](#ä½œæ¥­)
  - [10.6 a~p](#106-a~p)
  - [10.7 ä¿®æ”¹æ´—ç‰Œèˆ‡ç™¼ç‰Œç¨‹å¼](#107-ä¿®æ”¹æ´—ç‰Œèˆ‡ç™¼ç‰Œç¨‹å¼)
  - [10.11](#1011)
  - [10.14](#1014)
- [åƒè€ƒè³‡æ–™](#åƒè€ƒè³‡æ–™)

<!-- /code_chunk_output -->

# ç­†è¨˜
## ISO C++ forbids converting a string constant to â€˜char*â€™
åœ¨è¨­å®šè®Šæ•¸æ™‚ï¼Œå¦‚æœä½¿ç”¨Cèªè¨€å­—å‹è½‰æ›ï¼Œå°‡æœƒå‡ºç¾ä¸Šè¿°è­¦å‘Šè¨Šæ¯ï¼Œä½¿ç”¨æŒ‡å®šåˆ°ååƒè€ƒä¸­ï¼Œç³»çµ±æœƒè‡ªå‹•é€²è¡Œå‹æ…‹å®šç¾©ï¼Œä½†ä½¿ç”¨åƒè€ƒçš„æ–¹å¼é€™éƒ¨ä»½ä¸¦æœªå¼·åˆ¶å®šç¾©ï¼Œé€™æ™‚çµ±æœƒé€²è¡Œ implicit conversion æ“ä½œï¼Œ

```c
char* p = "abc"; // valid in C, invalid in C++
char* p = (char*) "abc"; //OK
char const *p = "abc";//OK
```

é€™åˆ°åº•æ˜¯æ€éº¼ä¸€å›äº‹å‘¢ï¼Ÿäº‹å¯¦ä¸Šï¼Œæˆ‘å€‘åœ¨å­¸ç¿’cæˆ–è€…c++çš„æ™‚å€™éƒ½çŸ¥é“ï¼Œå¦‚æœåœ¨æŒ‡å®šæ“ä½œçš„æ™‚å€™ï¼Œç­‰è™Ÿå…©é‚Šçš„è®Šæ•¸é¡å‹ä¸ä¸€æ¨£ï¼Œé‚£éº¼ç·¨è­¯å™¨æœƒé€²è¡Œä¸€ç¨®å«åšimplicit conversionçš„æ“ä½œä¾†ä½¿å¾—è®Šæ•¸å¯ä»¥è¢«æŒ‡å®šã€‚

åœ¨æˆ‘å€‘ä¸Šé¢çš„è¡¨é”å¼ä¸­å°±å­˜åœ¨é€™æ¨£çš„ä¸€å€‹å•é¡Œï¼Œç­‰è™Ÿå³é‚Šçš„ `"abc"` æ˜¯ä¸€å€‹ä¸è®Šè®Šæ•¸ï¼Œåœ¨c++ä¸­å«åšstring literalï¼Œtypeæ˜¯`const char *`ï¼Œè€Œ`p`å‰‡æ˜¯ä¸€å€‹`char`æŒ‡é‡ã€‚

å¦‚æœå¼·è¡ŒæŒ‡å®šæœƒç™¼ç”Ÿä»€éº¼å‘¢ï¼Ÿæ²’éŒ¯ï¼Œå°±æ˜¯å°‡å³é‚Šçš„è®Šæ•¸å¼·åˆ¶é¡å‹è½‰æ›æˆä¸€å€‹æŒ‡é‡ï¼Œçµæœå°±æ˜¯æˆ‘å€‘åœ¨ä¿®æ”¹ä¸€å€‹`const`è®Šæ•¸ã€‚ç·¨è­¯é‹è¡Œçš„çµæœæœƒå› ç·¨è­¯å™¨å’Œæ“ä½œç³»çµ±å…±åŒæ±ºå®šï¼Œæœ‰çš„ç·¨è­¯å™¨æœƒé€šéï¼Œæœ‰çš„æœƒè­¦å‘Šï¼Œå°±ç®—éäº†ä¹Ÿå¯èƒ½å› ç‚ºæ“ä½œç³»çµ±çš„æ•æ„Ÿæ€§è€Œè¢«æ®ºæ‰ã€‚

åƒé€™ç¨®ç›´æ¥å°‡string literalæŒ‡å®šçµ¦æŒ‡é‡çš„æ“ä½œè¢«é–‹ç™¼è€…å€‘èªç‚ºæ˜¯deprecatedï¼Œåªä¸éç”±æ–¼ä»¥å‰å¾ˆå¤šä»£ç¢¼éƒ½æœ‰é€™ç¨®ç¿’æ…£ï¼Œç‚ºäº†ç›¸å®¹å°±ä¿ç•™ä¸‹ä¾†äº†ã€‚

# ä½œæ¥­
## 10.6 a~p
ç¨‹å¼ç¢¼ï¼š

```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct customer {
  char lastName[15];
  char firstName[15];
  unsigned int customerNumber;
  struct {
    char phoneNumber[11];
    char address[50];
    char city[15];
    char state[3];
    char zipCode[6];
  } personal;
} customerRecord, *customerPtr;

int main(void) {
  customerPtr = &customerRecord;
  strcpy(customerRecord.lastName, "ç¿Ÿ");

  printf("%s\n\n", "(a)");
  printf("%s", customerRecord.lastName);

  printf("\n\n%s\n\n", "(b)");
  printf("%s", customerPtr->lastName);

  strcpy(customerRecord.firstName, "å®‰å¦‚");

  printf("\n\n%s\n\n", "(b)");
  printf("%s", customerRecord.firstName);

  printf("\n\n%s\n\n", "(c)");
  printf("%s", customerPtr->firstName);

  customerRecord.customerNumber = 1;

  printf("\n\n%s\n\n", "(e)");
  printf("%u", customerRecord.customerNumber);

  printf("\n\n%s\n\n", "(f)");
  printf("%u", customerPtr->customerNumber);

  strcpy(customerRecord.personal.phoneNumber, "099200135");

  printf("\n\n%s\n\n", "(g)");
  printf("%s", customerRecord.personal.phoneNumber);

  printf("\n\n%s\n\n", "(h)");
  printf("%s", customerPtr->personal.phoneNumber);

  strcpy(customerRecord.personal.address, "å…­ç”²å€å»ºåœ‹å—è·¯ä¹æ®µ219è™Ÿ");

  printf("\n\n%s\n\n", "(i)");
  printf("%s", customerRecord.personal.address);

  printf("\n\n%s\n\n", "(j)");
  printf("%s", customerPtr->personal.address);

  strcpy(customerRecord.personal.city, "è‡ºå—å¸‚");

  printf("\n\n%s\n\n", "(k)");
  printf("%s", customerRecord.personal.city);

  printf("\n\n%s\n\n", "(l)");
  printf("%s", customerPtr->personal.city);

  strcpy(customerRecord.personal.state, "ğŸ˜­");

  printf("\n\n%s\n\n", "(m)");
  printf("%s", customerRecord.personal.state);

  printf("\n\n%s\n\n", "(n)");
  printf("%s", customerPtr->personal.state);

  strcpy(customerRecord.personal.zipCode, "156");

  printf("\n\n%s\n\n", "(o)");
  printf("%s", customerRecord.personal.zipCode);

  printf("\n\n%s\n\n", "(p)");
  printf("%s", customerPtr->personal.zipCode);

  puts("");
}
```

åŸ·è¡Œçµæœï¼š

```
(a)

ç¿Ÿ

(b)

ç¿Ÿ

(b)

å®‰å¦‚

(c)

å®‰å¦‚

(e)

1

(f)

1

(g)

099200135

(h)

099200135

(i)

å…­ç”²å€å»ºåœ‹å—è·¯ä¹æ®µ219è™Ÿ

(j)

å…­ç”²å€å»ºåœ‹å—è·¯ä¹æ®µ219è™Ÿ

(k)

è‡ºå—å¸‚

(l)

è‡ºå—å¸‚

(m)

ğŸ˜­

(n)

ğŸ˜­

(o)

156

(p)

156
```

## 10.7 ä¿®æ”¹æ´—ç‰Œèˆ‡ç™¼ç‰Œç¨‹å¼
ç¨‹å¼ç¢¼ï¼š

```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define CARDS 52
#define FACES 13

struct bitCard {
  unsigned int face : 4;
  unsigned int suit : 2;
};

typedef struct bitCard Card;

void fillDeck(Card * const wDeck);
void shuffle(Card * const wDeck);
void deal(const Card * const wDeck);

int main(void) {
  Card deck[CARDS];
  srand(time(NULL));
  fillDeck(deck);
  shuffle(deck);
  deal(deck);
}

void fillDeck(Card * const wDeck) {
  for (size_t i = 0; i < CARDS; ++i) {
    wDeck[i].face = i % (CARDS / 4);
    wDeck[i].suit = i / (CARDS / 4);
  }
}

void shuffle(Card * const wDeck) {
  for (size_t i = 0; i < CARDS; ++i) {
    size_t j = rand() % CARDS;
    Card temp = wDeck[i];
    wDeck[i] = wDeck[j];
    wDeck[j] = temp;
  }
}

void deal(const Card * const wDeck) {
  char face[13][10] = {
    "Ace", "Deuce", "Three", "Four",
    "Five", "Six", "Seven", "Eight",
    "Nine", "Ten", "Jack", "Queen", "King"
  };
  char suit[4][10] = {"Hearts", "Diamonds", "Clubs", "Spades"};

  printf("%-10s%-15s%-10s%-10s\n", "Suit", "Card", "Suit", "Card");
  for (size_t k1 = 0, k2 = k1 + 26; k1 < CARDS / 2; ++k1, ++k2) {
    printf("%-10s%-15s", suit[wDeck[k1].suit], face[wDeck[k1].face]);
    printf("%-10s%-10s\n", suit[wDeck[k2].suit], face[wDeck[k2].face]);
  }
}
```

åŸ·è¡Œçµæœï¼š

```
Suit      Card           Suit      Card      
Spades    Deuce          Clubs     Deuce     
Clubs     Queen          Clubs     Nine      
Hearts    Eight          Spades    Jack      
Hearts    Deuce          Clubs     King      
Diamonds  Six            Spades    Five      
Spades    Queen          Hearts    Ace       
Clubs     Ace            Spades    Nine      
Spades    Eight          Diamonds  Ten       
Spades    Three          Clubs     Three     
Hearts    Six            Diamonds  Three     
Hearts    Five           Clubs     Seven     
Hearts    Nine           Diamonds  Nine      
Clubs     Five           Spades    Four      
Spades    Ace            Clubs     Six       
Diamonds  Five           Diamonds  Four      
Hearts    Four           Hearts    Ten       
Diamonds  King           Diamonds  Deuce     
Spades    Seven          Hearts    Jack      
Diamonds  Queen          Clubs     Ten       
Hearts    King           Clubs     Jack      
Diamonds  Jack           Spades    Ten       
Clubs     Four           Diamonds  Ace       
Hearts    Queen          Diamonds  Eight     
Hearts    Seven          Diamonds  Seven     
Hearts    Three          Spades    Six       
Spades    King           Clubs     Eight     
```

## 10.11
ç¨‹å¼ç¢¼ï¼š

```c
// Fig. 10.13: fig10_13.c
// Using the bitwise shift operators
#include <stdio.h>

void power_of_two(unsigned int number, unsigned int power);
void displayBits(unsigned int value);

int main(void) {
  unsigned int number = 960;
  unsigned int power = 0;

  puts("\nåŸæœ¬çš„æ•¸å­—");
  displayBits(number);
  printf("%u%s%u%s\n", number, "ä¹˜ä»¥2çš„", power, "æ¬¡æ–¹");
  power_of_two(number, power);

  power = 2;
  puts("\nåŸæœ¬çš„æ•¸å­—:");
  displayBits(number);
  printf("%u%s%u%s\n", number, "ä¹˜ä»¥2çš„", power, "æ¬¡æ–¹");
  power_of_two(number, power);

  power = 3;
  puts("\nåŸæœ¬çš„æ•¸å­—:");
  displayBits(number);
  printf("%u%s%u%s\n", number, "ä¹˜ä»¥2çš„", power, "æ¬¡æ–¹");
  power_of_two(number, power);
}

void power_of_two(unsigned int number, unsigned int power) {
  void displayBits(unsigned int value);
  displayBits(number << power);
}

void displayBits(unsigned int value) {
  unsigned int displayMask = 1 << 31;
  printf("%10u = ", value);
  for (unsigned int c = 1; c <= 32; ++c) {
    putchar(value & displayMask ? '1': '0');
    value <<= 1;
    if (c % 8 == 0) {
      putchar(' ');
    }
  }
  putchar('\n');
}
```

åŸ·è¡Œçµæœ

```

åŸæœ¬çš„æ•¸å­—
       960 = 00000000 00000000 00000011 11000000
960ä¹˜ä»¥2çš„0æ¬¡æ–¹
       960 = 00000000 00000000 00000011 11000000

åŸæœ¬çš„æ•¸å­—:
       960 = 00000000 00000000 00000011 11000000
960ä¹˜ä»¥2çš„2æ¬¡æ–¹
      3840 = 00000000 00000000 00001111 00000000

åŸæœ¬çš„æ•¸å­—:
       960 = 00000000 00000000 00000011 11000000
960ä¹˜ä»¥2çš„3æ¬¡æ–¹
      7680 = 00000000 00000000 00011110 00000000
```

## 10.14
ç¨‹å¼è¨­è¨ˆï¼š

```c
// Fig. 10.13: fig10_13.c
// Using the bitwise shift operators
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

void reverse_bits(unsigned int number);
void displayBits(unsigned int value);

int main(void) {
  srand(time(NULL));
  unsigned int number = rand() % 4294967296;

  puts("\nåŸæœ¬çš„æ•¸å­—");
  displayBits(number);
  printf("\n%s %u %s %lu %s\n", "å°‡æ•¸å­—", number, "åœ¨", (sizeof(number) * 8), "ä½å…ƒå¯¬åº¦é€²è¡ŒReverse Bits");
  reverse_bits(number);
}

void reverse_bits(unsigned int value) {
  void displayBits(unsigned int value);
  unsigned int bits = sizeof(value) * 8;
  unsigned int high = 0;
  unsigned int low = 0;
  for (unsigned int i = 1; i <= bits / 2; ++i) {
    high += (1 << (bits / 2 + (i - 1))) & (value << (i * 2 - 1));
    low += (1 << (bits / 2 - i)) & (value >> (i * 2 - 1));
  }
  displayBits(high + low);
}

void displayBits(unsigned int value) {
  unsigned int displayMask = 1 << 31;
  printf("%10u = ", value);
  for (unsigned int c = 1; c <= 32; ++c) {
    putchar(value & displayMask ? '1': '0');
    value <<= 1;
    if (c % 8 == 0) {
      putchar(' ');
    }
  }
  putchar('\n');
}
```

åŸ·è¡Œçµæœï¼š

```

åŸæœ¬çš„æ•¸å­—
2035826181 = 01111001 01011000 00111110 00000101

å°‡æ•¸å­— 2035826181 åœ¨ 32 ä½å…ƒå¯¬åº¦é€²è¡ŒReverse Bits
32
2692487838 = 10100000 01111100 00011010 10011110
```

# åƒè€ƒè³‡æ–™
- [Why is conversion from string constant to 'char*' valid in C but invalid in C++](https://stackoverflow.com/questions/20944784/why-is-conversion-from-string-constant-to-char-valid-in-c-but-invalid-in-c/20944858)
- [linux c++ è­¦å‘Šï¼š ISO C++ forbids converting a string constant to char*](https://blog.csdn.net/whatday/article/details/106267398)
